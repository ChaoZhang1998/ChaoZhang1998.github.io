<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Thu Oct 15 2020 06:15:15 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="5f87cc219fc4a60d693507e8" data-wf-site="5f798c2dcc9e363e88e3738a">

<head>
  <meta charset="utf-8">
  <title>3rd Project Post</title>
  <meta content="2nd Project Post" property="og:title">
  <meta content="2nd Project Post" property="twitter:title">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="css/normalize.css" rel="stylesheet" type="text/css">
  <link href="css/webflow.css" rel="stylesheet" type="text/css">
  <link href="css/the-natural.webflow.css" rel="stylesheet" type="text/css">
  <link href="prism/prism.css" rel="stylesheet" type="text/css">
  <!-- [if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif] -->
  <script type="text/javascript">
    ! function (o, c) {
      var n = c.documentElement,
        t = " w-mod-";
      n.className += t + "js", ("ontouchstart" in o || o.DocumentTouch && c instanceof DocumentTouch) && (n.className +=
        t + "touch")
    }(window, document);
  </script>
  <link href="images/favicon.ico" rel="shortcut icon" type="image/x-icon">
  <link href="images/webclip.ico" rel="apple-touch-icon">
</head>

<body>
  <div data-collapse="small" data-animation="over-right" data-duration="400" role="banner" class="navbar w-nav"><a
      href="natural.html" class="brand w-nav-brand"><img src="images/the-Natural.png" loading="lazy" width="188"
        sizes="(max-width: 479px) 85vw, 188px" srcset="images/the-Natural-p-500.png 500w, images/the-Natural.png 798w"
        alt="" class="brand-logo"></a>
    <nav role="navigation" class="nav-menu w-nav-menu"><a href="natural.html" class="nav-link w-nav-link">Home</a><a
        href="team.html" class="nav-link w-nav-link">Team</a><a href="project.html"
        class="nav-link w-nav-link">Project</a><a href="blog.html" class="nav-link w-nav-link">Blog</a></nav>
    <div class="menu-button w-nav-button">
      <div class="icon w-icon-nav-menu"></div>
    </div>
  </div>
  <div class="blog-section">
    <div class="blog-list w-container">
      <div class="blog-wrapper">
        <div class="blog-post"><a href="#" class="blog-link w-inline-block"><img src="images/p3-0.png" loading="lazy"
              width="1440" sizes="(max-width: 767px) 95vw, (max-width: 991px) 728px, 940px" alt=""></a>
          <div class="blog-heading-wrapper">
            <h1 class="blog-heading">Love Signal</h1>
            <div class="blog-byline-wrapper">
              <div class="blog-byline-wrapper">Third assignment documentary, 8 November 2020</div>
            </div>
          </div>
          <div class="blog-content-wrapper">
            <p class="blog-content">Even though couples are in different places, with the help of this product,
              long-distance lovers have a "missing link" that turns invisible thoughts into flickering light, like a
              heartbeat signal.</p>
            <p class="blog-content">The "Missing Signal" is designed for couples who are separated and in love, combined
              with the IoT technology background, using Arduino components. When one of the couples misses the other,
              they can click the "Missing Button" and the other couple will receive the signal instantly and the light
              will blink on, which is the "Missing Signal".</p>
            <p class="blog-content-cn">
              “思念的信号”是专为异地分居而又处于热恋的情侣所设计、结合IoT技术背景下，利用Arduino部件组成。当情侣中的一方想念对方时，可以点击“思念的按钮”，另一方就会即时地收到这个信号，灯就会闪烁亮起，这就是“思念的信号”。
            </p>
            <p class="blog-content">This product allows couples to send their thoughts in real time over the Internet to
              each other anywhere in the world. Even though couples are in different places, with the help of this
              product, long-distance lovers have a "missing link" that turns invisible thoughts into flickering light,
              like a heartbeat signal.</p>
            <p class="blog-content-cn">
              这款产品可以帮助情侣实时通过网络将他们的思念信号发送给处于全球任何一个位置的对方。尽管情侣身处异地，但是，在这款产品的帮助之下，异地恋情侣有了“思念的纽带”，让无形的念想转化为闪烁的光芒，犹如心动的信号。</p>
            <p class="blog-content"><b>Sources of Inspiration</b></p>
            <p class="blog-content-cn"><b>灵感来源</b></p>
            <p class="blog-content">For couples, long-distance relationships can be fraught with hardships and a lot of
              heartache, and although the Internet has made it easier for long-distance lovers to communicate with each
              other through a series of electronic devices, these methods still don't make it possible for long-distance
              lovers to interact in a warm and fun way.</p>
            <p class="blog-content-cn">
              对情侣而言，异地恋可能会充满艰辛，诸多的相思之痛很难得到抚慰，尽管互联网时代下的一系列电子设备已成为异地恋情侣之间相互联络的便捷途径，但细细看来，这些方式仍无法让异地恋情侣进行更加有温度且有趣的交流与互动。
            </p>
            <p class="blog-content">However, as technology advances, long-distance couples will be able to take
              advantage of the latest technology, such as IoT technology, to enhance interaction and communication.</p>
            <p class="blog-content-cn">不过，随着科技的发展，异地恋情侣也将能够充分利用最新科技的优势，比如IoT技术，来加强互动与交流。</p>
            <p class="blog-content"><b>Design Process</b></p>
            <p class="blog-content-cn"><b>设计过程</b></p>
            <p class="blog-content">We first assemble and debug the hardware components and programs separately.</p>
            <p class="blog-content-cn">我们先把硬件方面的元器件和程序分别组装和调试好。</p>
            <img src="images/p3-1.png" loading="lazy"
              sizes="(max-width: 767px) 76vw, (max-width: 991px) 582.390625px, 752px" alt="" class="blog-image">
            <img src="images/p3-2.png" loading="lazy"
              sizes="(max-width: 767px) 76vw, (max-width: 991px) 582.390625px, 752px" alt="" class="blog-image">
            <p class="blog-content">Then we quickly wrote the script for the product mini-theater, and each team member
              worked on his or her own part, creating the script in an orderly fashion.</p>
            <p class="blog-content-cn">接着我们很快编写了产品小剧场的分镜剧本，小组成员各司其职，有序展开了创作。</p>
            <img src="images/p3-3.png" loading="lazy"
              sizes="(max-width: 767px) 76vw, (max-width: 991px) 582.390625px, 752px" alt="" class="blog-image">
            <img src="images/p3-4.png" loading="lazy"
              sizes="(max-width: 767px) 76vw, (max-width: 991px) 582.390625px, 752px" alt="" class="blog-image">
            <img src="images/p3-5.png" loading="lazy"
              sizes="(max-width: 767px) 76vw, (max-width: 991px) 582.390625px, 752px" alt="" class="blog-image">
            <p class="blog-content"><b>Technical Section</b></p>
            <p class="blog-content-cn"><b>技术实现</b></p>
            <p class="blog-content">We use the following components:
              <br> NodeMCU*2
              <br> Pushbutton switch*2
              <br> YYClub's heart-shaped light*2
              <br> Arduino UNO*2
              <br> Wires, Resistors
              <br> Ali Cloud Server</p>
            <p class="blog-content-cn">我们采用了以下元器件：
              <br> NodeMCU*2
              <br> 按键开关*2
              <br> YYClub的心形灯*2
              <br> Arduino UNO*2
              <br> 导线，电阻若干
              <br> 阿里云服务器</p>
            <p class="blog-content"><b>Circuit diagram</b></p>
            <p class="blog-content-cn"><b>电路图</b></p>
            <p class="blog-content"><b>Program Design</b></p>
            <p class="blog-content-cn"><b>程序设计</b></p>
            <pre><code class="language-c">
#include <ESP8266WiFi.h>
#include <PubSubClient.h>
#include <ArduinoJson.h>
#include <aliyun_mqtt.h>



#define SENSOR_PIN 13    //pin define
#define LED D4
#define SWITCH D5
#define PRODUCT_KEY     "a1z4xHcSF1l"//exchange  PRODUCT_KEY
#define DEVICE_NAME     "LED2"//exchange  DEVICE_NAME
#define DEVICE_SECRET   "e33af9c38ab67e916bdfe55f9937a20f"//exchange DEVICE_SECRET

#define DEV_VERSION      "S-TH-WIFI-v1.0-20190220"

#define WIFI_SSID       "CST511"//exchange WIFI
#define WIFI_PASSWD     "511888666"//exchange WIFI password


  
#define ALINK_BODY_FORMAT         "{\"id\":\"123\",\"version\":\"1.0\",\"method\":\"%s\",\"params\":%s}"
#define ALINK_TOPIC_PROP_POST     "/sys/" PRODUCT_KEY "/" DEVICE_NAME "/thing/event/property/post"
#define ALINK_TOPIC_PROP_POSTRSP  "/sys/" PRODUCT_KEY "/" DEVICE_NAME "/thing/event/property/post_reply"
#define ALINK_TOPIC_PROP_SET      "/sys/" PRODUCT_KEY "/" DEVICE_NAME "/thing/service/property/set"
#define ALINK_METHOD_PROP_POST    "thing.event.property.post"
#define ALINK_TOPIC_DEV_INFO      "/ota/device/inform/" PRODUCT_KEY "/" DEVICE_NAME ""    
#define ALINK_VERSION_FROMA      "{\"id\": 123,\"params\": {\"version\": \"%s\"}}"
unsigned long lastMs = 0;
int val=0;

WiFiClient   espClient;
PubSubClient mqttClient(espClient);
  
void init_wifi(const char *ssid, const char *password)
{
    WiFi.mode(WIFI_STA);
    WiFi.begin(ssid, password);
    while (WiFi.status() != WL_CONNECTED)
    {
        Serial.println("WiFi does not connect, try again ...");
        delay(500);
    }
  
    Serial.println("Wifi is connected.");
    Serial.println("IP address: ");
    Serial.println(WiFi.localIP());
}
  
void mqtt_callback(char *topic, byte *payload, unsigned int length)
{
    Serial.print("Message arrived [");
    Serial.print(topic);
    Serial.print("] ");
    payload[length] = '\0';
    Serial.println((char *)payload);
  
    Serial.println("");
    Serial.println((char *)payload);
    Serial.println("");
  
    if (strstr(topic, ALINK_TOPIC_PROP_SET))
    {
        StaticJsonBuffer<100> jsonBuffer;
        JsonObject &root = jsonBuffer.parseObject(payload);
        int params_LightSwitch = root["LightSwitch1"];
        if(params_LightSwitch == 0)
        { 
          Serial.println("Led on");
          digitalWrite(LED,HIGH);
        }
        else
        { 
          Serial.println("Led off");
          digitalWrite(LED,LOW);
        }
        
        if (!root.success())
        {
          Serial.println("parseObject() failed");
          return;
        }
    }
}
void mqtt_version_post()
{
    char param[512];
    //char jsonBuf[1024];

    sprintf(param, "{\"id\": 222,\"params\": {\"version\": \"%s\"}}", DEV_VERSION);
    //sprintf(jsonBuf, ALINK_BODY_FORMAT, ALINK_METHOD_PROP_POST, param);
    Serial.println(param);
    mqttClient.publish(ALINK_TOPIC_DEV_INFO, param);
}
void mqtt_check_connect()
{
    while (!mqttClient.connected())//mqttδ
    {
        while (connect_aliyun_mqtt(mqttClient, PRODUCT_KEY, DEVICE_NAME, DEVICE_SECRET))
        {
            Serial.println("MQTT connect succeed!");
            //client.subscribe(ALINK_TOPIC_PROP_POSTRSP);
            mqttClient.subscribe(ALINK_TOPIC_PROP_SET);
            
            Serial.println("subscribe done");
            mqtt_version_post();
        }
    }
    
}
  
void mqtt_interval_post()
{
    char param[512];
    char jsonBuf[1024];
  
    sprintf(param, "{\"LightSwitch2\":%d,\"Range2\":%d}", digitalRead(SWITCH), val);
    sprintf(jsonBuf, ALINK_BODY_FORMAT, ALINK_METHOD_PROP_POST, param);
    Serial.println(jsonBuf);
    mqttClient.publish(ALINK_TOPIC_PROP_POST, jsonBuf);
}
  
  
void setup()
{
  
    pinMode(SENSOR_PIN, INPUT);
    pinMode(LED, OUTPUT);
    /* initialize serial for debugging */
    Serial.begin(115200);
  
    Serial.println("Demo Start");
  
    init_wifi(WIFI_SSID, WIFI_PASSWD);
  
    mqttClient.setCallback(mqtt_callback);
}
  
// the loop function runs over and over again forever
void loop()
{
    val = 100;
    
    if (millis() - lastMs >= 5000)
    {
        lastMs = millis();
        mqtt_check_connect();
        /* Post */        
        mqtt_interval_post();
    }
  
    mqttClient.loop();
  
    unsigned int WAIT_MS = 2000;
    if (digitalRead(SENSOR_PIN) == HIGH)
    {
        Serial.println("Motion detected!");
    }
    else
    {
        Serial.println("Motion absent!");
    }
    delay(WAIT_MS); // ms
    Serial.println(millis() / WAIT_MS);
}
            </code></pre>
            <p class="blog-content">Here&#x27;s our video showcase 👇</p>
            <p class="blog-content-cn">以下是我们的视频展示 👇</p>
          </div>
          <div style="padding-top:56.17021276595745%" id="w-node-4402348943b9-693507e8"
            class="w-embed-youtubevideo video"><iframe
              src="https://www.youtube.com/embed/64IjtHS-yuw?rel=0&amp;controls=1&amp;autoplay=0&amp;mute=0&amp;start=5"
              frameborder="0" style="position:absolute;left:0;top:0;width:100%;height:100%;pointer-events:auto"
              allow="autoplay; encrypted-media" allowfullscreen=""></iframe></div>
        </div>
      </div>
      <p class="blog-content"><b>"How do you know I'm thinking of you?"</b>
        <br><b>"Because I got the signal that you miss me."</b></p>
      <p class="blog-content-cn"><b>“你怎么知道我在想你啊？”</b>
        <br><b>“因为我收到了你想我的信号。”</b></p>
    </div>
  </div>
  </div>
  <div class="footer">
    <div class="w-layout-grid footer-links">
      <div id="w-node-1087d2ef69f1-d2ef69e6" class="footer-zju"><a href="http://www.zju.edu.cn/" target="_blank"
          class="footer-brand w-nav-brand"><img src="images/zju.png" loading="lazy" width="140" alt=""
            class="footer-brand-logo"></a>
        <div class="footer-link-container"><a id="w-node-1087d2ef69f5-d2ef69e6" href="natural.html"
            class="footer-link">Home</a><a id="w-node-1087d2ef69f7-d2ef69e6" href="team.html"
            class="footer-link">Team</a><a id="w-node-1087d2ef69f9-d2ef69e6" href="project.html"
            class="footer-link">Project</a><a id="w-node-1087d2ef69fb-d2ef69e6" href="blog.html"
            class="footer-link">Blog</a></div>
      </div>
      <div class="footer-natural"><a href="natural.html" class="footer-brand w-nav-brand"><img
            src="images/the-Natural.png" loading="lazy" width="188" sizes="(max-width: 479px) 73vw, 188px"
            srcset="images/the-Natural-p-500.png 500w, images/the-Natural.png 798w" alt=""
            class="footer-brand-logo"></a>
        <p><strong class="footer-slogan">Each design of the team aims to get closer to the original exploration.
          </strong></p>
        <p class="paragraph"><strong class="footer-copyright">2020 © Terms of Service - Privacy Policy</strong></p>
      </div>
    </div>
  </div>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=5f798c2dcc9e363e88e3738a"
    type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous">
  </script>
  <script src="js/webflow.js" type="text/javascript"></script>
  <script src="prism/prism.js" type="text/javascript"></script>
  <!-- [if lte IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif] -->
</body>

</html>